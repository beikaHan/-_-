(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"8vIy":function(e,t,a){e.exports={classManageList:"antd-pro\\pages\\-title-manage\\-manage-classManageList",tableListOperator:"antd-pro\\pages\\-title-manage\\-manage-tableListOperator",mockBtn:"antd-pro\\pages\\-title-manage\\-manage-mockBtn",classManageListForm:"antd-pro\\pages\\-title-manage\\-manage-classManageListForm",submitButtons:"antd-pro\\pages\\-title-manage\\-manage-submitButtons",tableListForm:"antd-pro\\pages\\-title-manage\\-manage-tableListForm",classManageEdit:"antd-pro\\pages\\-title-manage\\-manage-classManageEdit",content:"antd-pro\\pages\\-title-manage\\-manage-content",tilflex:"antd-pro\\pages\\-title-manage\\-manage-tilflex",upload:"antd-pro\\pages\\-title-manage\\-manage-upload"}},"Tc/F":function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var i=l(a("2/Rp"));a("DZo9");var r=l(a("8z0m"));a("5NDa");var s=l(a("5rEg"));a("giR+");var o=l(a("fyUT"));a("Pwec");var u=l(a("CtXQ"));a("/xke");var d=l(a("TeRw")),c=l(a("lwsE")),g=l(a("W8MJ")),m=l(a("a1gu")),f=l(a("Nsbk")),p=l(a("7W2i")),h=l(a("PJYZ"));a("miYZ");var y=l(a("tsqr"));a("y8nQ");var v,k,E,C=l(a("Vl3Y")),b=n(a("q1tI")),I=a("MuoO"),w=l(a("XZXw")),M=a("7Qib"),L=l(a("kruT")),R=l(a("8vIy")),U=(l(a("FnG8")),C.default.Item);function x(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||y.default.error("\u4ec5\u652f\u6301jpg\u6216png\u683c\u5f0f");var a=e.size/1024/1024<2;return a||y.default.error("\u56fe\u7247\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc72MB!"),t&&a}var S=(v=(0,I.connect)(function(e){return{titleManage:e.titleManage}}),k=C.default.create(),v(E=k(E=function(e){function t(){var e,a;(0,c.default)(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return a=(0,m.default)(this,(e=(0,f.default)(t)).call.apply(e,[this].concat(n))),a.state={items:[{key:0,isDefault:0,imageResourceId:null,title:null,score:null,imageUrl:null}],loadingImg:{}},a.changeUploadList=function(e,t){var l=a.state.items&&a.state.items.length>0?a.state.items.slice(0):[];if("plus"===e){for(var n=0,i=0;i<l.length;i++)n=0===i?l[i].key:l[i].key>l[i-1].key?l[i].key:l[i-1].key;l.push({key:n+1,isDefault:0,imageResourceId:null,title:null,score:null,imageUrl:null})}else{for(var r=0;r<l.length;r++)if(t===l[r].key){l.splice(r,1);break}l.length<=0&&(d.default.error({message:"\u81f3\u5c11\u4fdd\u7559\u4e00\u6761"}),l.push({key:0,isDefault:0,imageResourceId:null,title:null,score:null,imageUrl:null}))}a.setState({items:l})},a.handleresourceChange=function(e,t){var l=a.state.items&&a.state.items.length>0?a.state.items.slice(0):[],n=a.state.loadingImg;if("uploading"===e.file.status)return n[t]=!0,void a.setState({loadingImg:n});if("done"===e.file.status){for(var i=0;i<l.length;i++)if(t===l[i].key){n[t]=!1,l[i].key=t,l[i].imageResourceId=e.file.response.resource.id,l[i].imageUrl=e.file.response.resource.url;break}a.setState({loadingImg:n,items:l,imageUrl:e.file.response.resource.url})}},a.iptChange=function(e,t){for(var l=a.state.items&&a.state.items.length>0?a.state.items.slice(0):[],n=0;n<l.length;n++)if(t===l[n].key){l[n].score=e;break}a.setState({items:l})},a.titleChange=function(e,t){for(var l=a.state.items&&a.state.items.length>0?a.state.items.slice(0):[],n=0;n<l.length;n++)if(t===l[n].key){l[n].title=e.target.value;break}a.setState({items:l})},a.handleChange=function(e){e.preventDefault();var t=a.state.items,l={},n=((0,h.default)((0,h.default)(a)),a.props),i=n.dispatch,r=n.form;if(0!==t.length||null!=t[0].imageResourceId||null!=t[0].score||null!=t[0].title){for(var s=0;s<t.length;s++){if(null==t[s].imageResourceId||null==t[s].score||null==t[s].title)return void d.default.error({message:"\u8bf7\u586b\u5199\u5b8c\u6574\u5934\u8854\u4fe1\u606f"});if(l[t[s].score])return void d.default.error({message:"\u4e0d\u80fd\u8bbe\u7f6e\u91cd\u590d\u5206\u6570"});l[t[s].score]=!0}r.validateFields(function(e,a){e||i({type:"titleManage/addSchoolRankData",payload:{items:t}})})}else d.default.error({message:"\u6682\u65e0\u4efb\u4f55\u4fdd\u5b58\u4fe1\u606f"})},a.handleCancel=function(){var e=(0,h.default)((0,h.default)(a));a.props.dispatch({type:"titleManage/getSchoolRankList",callback:function(t){t&&t.length>0&&e.setState({items:t,loadingImg:{}})}})},a}return(0,p.default)(t,e),(0,g.default)(t,[{key:"componentDidMount",value:function(){this.handleCancel()}},{key:"render",value:function(){var e=this,t=this.props,a=t.titleManage,l=(a.loading,a.schoolRankAll,t.form.getFieldDecorator),n=this.state,d=n.items,c=(n.imageUrl,n.loadingImg);b.default.createElement("div",null,b.default.createElement(u.default,{type:this.state.loading?"loading":"plus"}),b.default.createElement("div",{className:"ant-upload-text"},"\u5934\u8854\u56fe\u7247"));return b.default.createElement(w.default,{title:"\u5934\u8854\u7ba1\u7406"},b.default.createElement(C.default,{onSubmit:this.handleChange},d&&d.map(function(t,a){return b.default.createElement("div",{className:R.default.upload,key:t.key},b.default.createElement(U,null,l("".concat(t.key).concat(t.score).concat(t.imageResourceId),{initialValue:void 0!=t&&void 0!=t.score?t.score:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5934\u8854\u5206\u6570"}]})(b.default.createElement(o.default,{placeholder:"\u8bf7\u8f93\u5165\u5934\u8854\u5206\u6570",min:1,style:{width:"100%"},onChange:function(a){return e.iptChange(a,t.key)}}))),b.default.createElement(U,null,l("".concat(t.key).concat(t.title),{initialValue:void 0!=t&&void 0!=t.title?t.title:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}]})(b.default.createElement(s.default,{placeholder:"\u8bf7\u8f93\u5165\u5934\u8854\u540d\u79f0",maxLength:"30",autoComplete:"off",onChange:function(a){return e.titleChange(a,t.key,t.score,t.title)}}))),b.default.createElement(r.default,{name:"file",showUploadList:!1,listType:"picture-card",headers:{JSESSIONID:(0,M.getCookie)()?(0,M.getCookie)():null},action:"".concat(L.default.baseURL,"/resource/upload"),beforeUpload:x,onChange:function(a){return e.handleresourceChange(a,t.key)}},void 0!=t&&void 0!=t.url?b.default.createElement("img",{src:t.url,alt:"ava"}):t.imageUrl?b.default.createElement("img",{src:t.imageUrl,alt:"ava"}):b.default.createElement("div",null,b.default.createElement(u.default,{type:c[t.key]?"loading":"plus"}),b.default.createElement("div",{className:"ant-upload-text"},"Upload"))),b.default.createElement(i.default,{type:"danger",ghost:!0,style:{float:"right"},onClick:function(){return e.changeUploadList("minus",t.key)}},"\u5220\u9664"))}),b.default.createElement("div",{style:{width:"100%"}},b.default.createElement("div",{style:{width:"100%",textAlign:"center"}},"\u56fe\u7247\u4ec5\u652f\u6301jpg\u6216png\u683c\u5f0f\uff0c\u4e14\u5927\u5c0f\u4e0d\u8d85\u8fc72MB\uff0c\u5c3a\u5bf8\u4e3a120*120"),b.default.createElement(i.default,{style:{width:"100%",marginTop:16,marginBottom:8},type:"dashed",onClick:function(){return e.changeUploadList("plus")},icon:"plus",id:"mediaBtn"},"\u6dfb\u52a0")),b.default.createElement("span",{style:{width:"100%",display:"block",textAlign:"center"}},b.default.createElement(i.default,{type:"primary",htmlType:"submit",style:{marginRight:"20px",padding:"0 50px"}},"\u4fdd\u5b58"),b.default.createElement(i.default,{onClick:this.handleCancel,style:{padding:"0 50px"}},"\u53d6\u6d88"))))}}]),t}(b.Component))||E)||E);t.default=S}}]);